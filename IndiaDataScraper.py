import datetime
import json
import time
import pandas as pd
import os
import requests

INDIA_URL = "https://api.cowin.gov.in/api/v1/reports/v2/getPublicReports"
vaccineHeader = ['Date',
 'Vaccine_total', 'Vaccine_male', 'Vaccine_female', 'Vaccine_others', 'Vaccine_covishield', 'Vaccine_covaxin', 'Vaccine_today', 'Vaccine_tot_dose1','Vaccine_tot_dose2', 'Vaccine_tot_dose', 'Vaccine_aefi', 'Vaccine_today_dose1', 'Vaccine_today_dose2', 'Vaccine_today_male','Vaccine_today_female', 'Vaccine_today_others',
 'Vaccine_today_aefi,', 'Vaccine_time_07:00-08:00', 'Vaccine_time_07:00-08:00_count', 'Vaccine_time_07:00-08:00_dose_one',
 'Vaccine_time_07:00-08:00_dose_two','Vaccine_time_08:00-09:00', 'Vaccine_time_08:00-09:00_count',
 'Vaccine_time_08:00-09:00_dose_one', 'Vaccine_time_08:00-09:00_dose_two', 'Vaccine_time_09:00-10:00',
 'Vaccine_time_09:00-10:00_count', 'Vaccine_time_09:00-10:00_dose_one', 'Vaccine_time_09:00-10:00_dose_two',
 'Vaccine_time_10:00-11:00','Vaccine_time_10:00-11:00_count',
 'Vaccine_time_10:00-11:00_dose_one',
 'Vaccine_time_10:00-11:00_dose_two',
 'Vaccine_time_11:00-12:00',
 'Vaccine_time_11:00-12:00_count',
 'Vaccine_time_11:00-12:00_dose_one',
 'Vaccine_time_11:00-12:00_dose_two',
 'Vaccine_time_12:00-13:00',
 'Vaccine_time_12:00-13:00_count',
 'Vaccine_time_12:00-13:00_dose_one',
 'Vaccine_time_12:00-13:00_dose_two',
 'Vaccine_time_13:00-14:00',
 'Vaccine_time_13:00-14:00_count',
 'Vaccine_time_13:00-14:00_dose_one',
 'Vaccine_time_13:00-14:00_dose_two',
 'Vaccine_time_14:00-15:00',
 'Vaccine_time_14:00-15:00_count',
 'Vaccine_time_14:00-15:00_dose_one',
 'Vaccine_time_14:00-15:00_dose_two',
 'Vaccine_time_15:00-16:00',
 'Vaccine_time_15:00-16:00_count',
 'Vaccine_time_15:00-16:00_dose_one',
 'Vaccine_time_15:00-16:00_dose_two',
 'Vaccine_time_16:00-17:00',
 'Vaccine_time_16:00-17:00_count',
 'Vaccine_time_16:00-17:00_dose_one',
 'Vaccine_time_16:00-17:00_dose_two',
 'Vaccine_time_17:00-18:00',
 'Vaccine_time_17:00-18:00_count',
 'Vaccine_time_17:00-18:00_dose_one',
 'Vaccine_time_17:00-18:00_dose_two',
 'Vaccine_time_18:00-19:00',
 'Vaccine_time_18:00-19:00_count',
 'Vaccine_time_18:00-19:00_dose_one',
 'Vaccine_time_18:00-19:00_dose_two',
 'Vaccine_time_19:00-20:00',
 'Vaccine_time_19:00-20:00_count',
 'Vaccine_time_19:00-20:00_dose_one',
 'Vaccine_time_19:00-20:00_dose_two',
 'Vaccine_time_20:00-21:00',
 'Vaccine_time_20:00-21:00_count',
 'Vaccine_time_20:00-21:00_dose_one',
 'Vaccine_time_20:00-21:00_dose_two',
 'Vaccine_time_21:00-22:00',
 'Vaccine_time_21:00-22:00_count',
 'Vaccine_time_21:00-22:00_dose_one',
 'Vaccine_time_21:00-22:00_dose_two',
 'Vaccine_time_22:00-23:00',
 'Vaccine_time_22:00-23:00_count',
 'Vaccine_time_22:00-23:00_dose_one',
 'Vaccine_time_22:00-23:00_dose_two',
 'aefiPercentage',
 'Vaccine_total',
 'Vaccine_18_30',
 'Vaccine_30_45',
 'Vaccine_45_60',
 'Vaccine_above_60']
 
 regisHeader = ['Date', 'Registration_total', 'Registration_18_45', 'Registration_45_above', 'Registration_today',
                'Reg_time_00:00-01:00','Reg_time_00:00-01:00_total',
 'Reg_time_00:00-01:00_age18',
 'Reg_time_00:00-01:00_age45',
 'Reg_time_00:00-01:00_age60',
 'Reg_time_00:00-01:00_male',
 'Reg_time_00:00-01:00_female',
 'Reg_time_00:00-01:00_others',
 'Reg_time_01:00-02:00',
 'Reg_time_01:00-02:00_total',
 'Reg_time_01:00-02:00_age18',
 'Reg_time_01:00-02:00_age45',
 'Reg_time_01:00-02:00_age60',
 'Reg_time_01:00-02:00_male',
 'Reg_time_01:00-02:00_female',
 'Reg_time_01:00-02:00_others',
 'Reg_time_02:00-03:00',
 'Reg_time_02:00-03:00_total',
 'Reg_time_02:00-03:00_age18',
 'Reg_time_02:00-03:00_age45',
 'Reg_time_02:00-03:00_age60',
 'Reg_time_02:00-03:00_male',
 'Reg_time_02:00-03:00_female',
 'Reg_time_02:00-03:00_others',
 'Reg_time_03:00-04:00',
 'Reg_time_03:00-04:00_total',
 'Reg_time_03:00-04:00_age18',
 'Reg_time_03:00-04:00_age45',
 'Reg_time_03:00-04:00_age60',
 'Reg_time_03:00-04:00_male',
 'Reg_time_03:00-04:00_female',
 'Reg_time_03:00-04:00_others',
 'Reg_time_04:00-05:00',
 'Reg_time_04:00-05:00_total',
 'Reg_time_04:00-05:00_age18',
 'Reg_time_04:00-05:00_age45',
 'Reg_time_04:00-05:00_age60',
 'Reg_time_04:00-05:00_male',
 'Reg_time_04:00-05:00_female',
 'Reg_time_04:00-05:00_others',
 'Reg_time_05:00-06:00',
 'Reg_time_05:00-06:00_total',
 'Reg_time_05:00-06:00_age18',
 'Reg_time_05:00-06:00_age45',
 'Reg_time_05:00-06:00_age60',
 'Reg_time_05:00-06:00_male',
 'Reg_time_05:00-06:00_female',
 'Reg_time_05:00-06:00_others',
 'Reg_time_06:00-07:00',
 'Reg_time_06:00-07:00_total',
 'Reg_time_06:00-07:00_age18',
 'Reg_time_06:00-07:00_age45',
 'Reg_time_06:00-07:00_age60',
 'Reg_time_06:00-07:00_male',
 'Reg_time_06:00-07:00_female',
 'Reg_time_06:00-07:00_others',
 'Reg_time_07:00-08:00',
 'Reg_time_07:00-08:00_total',
 'Reg_time_07:00-08:00_age18',
 'Reg_time_07:00-08:00_age45',
 'Reg_time_07:00-08:00_age60',
 'Reg_time_07:00-08:00_male',
 'Reg_time_07:00-08:00_female',
 'Reg_time_07:00-08:00_others',
 'Reg_time_08:00-09:00',
 'Reg_time_08:00-09:00_total',
 'Reg_time_08:00-09:00_age18',
 'Reg_time_08:00-09:00_age45',
 'Reg_time_08:00-09:00_age60',
 'Reg_time_08:00-09:00_male',
 'Reg_time_08:00-09:00_female',
 'Reg_time_08:00-09:00_others',
 'Reg_time_09:00-10:00',
 'Reg_time_09:00-10:00_total',
 'Reg_time_09:00-10:00_age18',
 'Reg_time_09:00-10:00_age45',
 'Reg_time_09:00-10:00_age60',
 'Reg_time_09:00-10:00_male',
 'Reg_time_09:00-10:00_female',
 'Reg_time_09:00-10:00_others',
 'Reg_time_10:00-11:00',
 'Reg_time_10:00-11:00_total',
 'Reg_time_10:00-11:00_age18',
 'Reg_time_10:00-11:00_age45',
 'Reg_time_10:00-11:00_age60',
 'Reg_time_10:00-11:00_male',
 'Reg_time_10:00-11:00_female',
 'Reg_time_10:00-11:00_others',
 'Reg_time_11:00-12:00',
 'Reg_time_11:00-12:00_total',
 'Reg_time_11:00-12:00_age18',
 'Reg_time_11:00-12:00_age45',
 'Reg_time_11:00-12:00_age60',
 'Reg_time_11:00-12:00_male',
 'Reg_time_11:00-12:00_female',
 'Reg_time_11:00-12:00_others',
 'Reg_time_12:00-13:00',
 'Reg_time_12:00-13:00_total',
 'Reg_time_12:00-13:00_age18',
 'Reg_time_12:00-13:00_age45',
 'Reg_time_12:00-13:00_age60',
 'Reg_time_12:00-13:00_male',
 'Reg_time_12:00-13:00_female',
 'Reg_time_12:00-13:00_others',
 'Reg_time_13:00-14:00',
 'Reg_time_13:00-14:00_total',
 'Reg_time_13:00-14:00_age18',
 'Reg_time_13:00-14:00_age45',
 'Reg_time_13:00-14:00_age60',
 'Reg_time_13:00-14:00_male',
 'Reg_time_13:00-14:00_female',
 'Reg_time_13:00-14:00_others',
 'Reg_time_14:00-15:00',
 'Reg_time_14:00-15:00_total',
 'Reg_time_14:00-15:00_age18',
 'Reg_time_14:00-15:00_age45',
 'Reg_time_14:00-15:00_age60',
 'Reg_time_14:00-15:00_male',
 'Reg_time_14:00-15:00_female',
 'Reg_time_14:00-15:00_others',
 'Reg_time_15:00-16:00',
 'Reg_time_15:00-16:00_total',
 'Reg_time_15:00-16:00_age18',
 'Reg_time_15:00-16:00_age45',
 'Reg_time_15:00-16:00_age60',
 'Reg_time_15:00-16:00_male',
 'Reg_time_15:00-16:00_female',
 'Reg_time_15:00-16:00_others',
 'Reg_time_16:00-17:00',
 'Reg_time_16:00-17:00_total',
 'Reg_time_16:00-17:00_age18',
 'Reg_time_16:00-17:00_age45',
 'Reg_time_16:00-17:00_age60',
 'Reg_time_16:00-17:00_male',
 'Reg_time_16:00-17:00_female',
 'Reg_time_16:00-17:00_others',
 'Reg_time_17:00-18:00',
 'Reg_time_17:00-18:00_total',
 'Reg_time_17:00-18:00_age18',
 'Reg_time_17:00-18:00_age45',
 'Reg_time_17:00-18:00_age60',
 'Reg_time_17:00-18:00_male',
 'Reg_time_17:00-18:00_female',
 'Reg_time_17:00-18:00_others',
 'Reg_time_18:00-19:00',
 'Reg_time_18:00-19:00_total',
 'Reg_time_18:00-19:00_age18',
 'Reg_time_18:00-19:00_age45',
 'Reg_time_18:00-19:00_age60',
 'Reg_time_18:00-19:00_male',
 'Reg_time_18:00-19:00_female',
 'Reg_time_18:00-19:00_others',
 'Reg_time_19:00-20:00',
 'Reg_time_19:00-20:00_total',
 'Reg_time_19:00-20:00_age18',
 'Reg_time_19:00-20:00_age45',
 'Reg_time_19:00-20:00_age60',
 'Reg_time_19:00-20:00_male',
 'Reg_time_19:00-20:00_female',
 'Reg_time_19:00-20:00_others',
 'Reg_time_20:00-21:00',
 'Reg_time_20:00-21:00_total',
 'Reg_time_20:00-21:00_age18',
 'Reg_time_20:00-21:00_age45',
 'Reg_time_20:00-21:00_age60',
 'Reg_time_20:00-21:00_male',
 'Reg_time_20:00-21:00_female',
 'Reg_time_20:00-21:00_others',
 'Reg_time_21:00-22:00',
 'Reg_time_21:00-22:00_total',
 'Reg_time_21:00-22:00_age18',
 'Reg_time_21:00-22:00_age45',
 'Reg_time_21:00-22:00_age60',
 'Reg_time_21:00-22:00_male',
 'Reg_time_21:00-22:00_female',
 'Reg_time_21:00-22:00_others',
 'Reg_time_22:00-23:00',
 'Reg_time_22:00-23:00_total',
 'Reg_time_22:00-23:00_age18',
 'Reg_time_22:00-23:00_age45',
 'Reg_time_22:00-23:00_age60',
 'Reg_time_22:00-23:00_male',
 'Reg_time_22:00-23:00_female',
 'Reg_time_22:00-23:00_others']

regisHeader = ['Date', 'Registration_total', 'Registration_18_45', 'Registration_45_above', 'Registration_today',
                'Reg_time_00:00-01:00','Reg_time_00:00-01:00_total',
 'Reg_time_00:00-01:00_age18',
 'Reg_time_00:00-01:00_age45',
 'Reg_time_00:00-01:00_age60',
 'Reg_time_00:00-01:00_male',
 'Reg_time_00:00-01:00_female',
 'Reg_time_00:00-01:00_others',
 'Reg_time_01:00-02:00',
 'Reg_time_01:00-02:00_total',
 'Reg_time_01:00-02:00_age18',
 'Reg_time_01:00-02:00_age45',
 'Reg_time_01:00-02:00_age60',
 'Reg_time_01:00-02:00_male',
 'Reg_time_01:00-02:00_female',
 'Reg_time_01:00-02:00_others',
 'Reg_time_02:00-03:00',
 'Reg_time_02:00-03:00_total',
 'Reg_time_02:00-03:00_age18',
 'Reg_time_02:00-03:00_age45',
 'Reg_time_02:00-03:00_age60',
 'Reg_time_02:00-03:00_male',
 'Reg_time_02:00-03:00_female',
 'Reg_time_02:00-03:00_others',
 'Reg_time_03:00-04:00',
 'Reg_time_03:00-04:00_total',
 'Reg_time_03:00-04:00_age18',
 'Reg_time_03:00-04:00_age45',
 'Reg_time_03:00-04:00_age60',
 'Reg_time_03:00-04:00_male',
 'Reg_time_03:00-04:00_female',
 'Reg_time_03:00-04:00_others',
 'Reg_time_04:00-05:00',
 'Reg_time_04:00-05:00_total',
 'Reg_time_04:00-05:00_age18',
 'Reg_time_04:00-05:00_age45',
 'Reg_time_04:00-05:00_age60',
 'Reg_time_04:00-05:00_male',
 'Reg_time_04:00-05:00_female',
 'Reg_time_04:00-05:00_others',
 'Reg_time_05:00-06:00',
 'Reg_time_05:00-06:00_total',
 'Reg_time_05:00-06:00_age18',
 'Reg_time_05:00-06:00_age45',
 'Reg_time_05:00-06:00_age60',
 'Reg_time_05:00-06:00_male',
 'Reg_time_05:00-06:00_female',
 'Reg_time_05:00-06:00_others',
 'Reg_time_06:00-07:00',
 'Reg_time_06:00-07:00_total',
 'Reg_time_06:00-07:00_age18',
 'Reg_time_06:00-07:00_age45',
 'Reg_time_06:00-07:00_age60',
 'Reg_time_06:00-07:00_male',
 'Reg_time_06:00-07:00_female',
 'Reg_time_06:00-07:00_others',
 'Reg_time_07:00-08:00',
 'Reg_time_07:00-08:00_total',
 'Reg_time_07:00-08:00_age18',
 'Reg_time_07:00-08:00_age45',
 'Reg_time_07:00-08:00_age60',
 'Reg_time_07:00-08:00_male',
 'Reg_time_07:00-08:00_female',
 'Reg_time_07:00-08:00_others',
 'Reg_time_08:00-09:00',
 'Reg_time_08:00-09:00_total',
 'Reg_time_08:00-09:00_age18',
 'Reg_time_08:00-09:00_age45',
 'Reg_time_08:00-09:00_age60',
 'Reg_time_08:00-09:00_male',
 'Reg_time_08:00-09:00_female',
 'Reg_time_08:00-09:00_others',
 'Reg_time_09:00-10:00',
 'Reg_time_09:00-10:00_total',
 'Reg_time_09:00-10:00_age18',
 'Reg_time_09:00-10:00_age45',
 'Reg_time_09:00-10:00_age60',
 'Reg_time_09:00-10:00_male',
 'Reg_time_09:00-10:00_female',
 'Reg_time_09:00-10:00_others',
 'Reg_time_10:00-11:00',
 'Reg_time_10:00-11:00_total',
 'Reg_time_10:00-11:00_age18',
 'Reg_time_10:00-11:00_age45',
 'Reg_time_10:00-11:00_age60',
 'Reg_time_10:00-11:00_male',
 'Reg_time_10:00-11:00_female',
 'Reg_time_10:00-11:00_others',
 'Reg_time_11:00-12:00',
 'Reg_time_11:00-12:00_total',
 'Reg_time_11:00-12:00_age18',
 'Reg_time_11:00-12:00_age45',
 'Reg_time_11:00-12:00_age60',
 'Reg_time_11:00-12:00_male',
 'Reg_time_11:00-12:00_female',
 'Reg_time_11:00-12:00_others',
 'Reg_time_12:00-13:00',
 'Reg_time_12:00-13:00_total',
 'Reg_time_12:00-13:00_age18',
 'Reg_time_12:00-13:00_age45',
 'Reg_time_12:00-13:00_age60',
 'Reg_time_12:00-13:00_male',
 'Reg_time_12:00-13:00_female',
 'Reg_time_12:00-13:00_others',
 'Reg_time_13:00-14:00',
 'Reg_time_13:00-14:00_total',
 'Reg_time_13:00-14:00_age18',
 'Reg_time_13:00-14:00_age45',
 'Reg_time_13:00-14:00_age60',
 'Reg_time_13:00-14:00_male',
 'Reg_time_13:00-14:00_female',
 'Reg_time_13:00-14:00_others',
 'Reg_time_14:00-15:00',
 'Reg_time_14:00-15:00_total',
 'Reg_time_14:00-15:00_age18',
 'Reg_time_14:00-15:00_age45',
 'Reg_time_14:00-15:00_age60',
 'Reg_time_14:00-15:00_male',
 'Reg_time_14:00-15:00_female',
 'Reg_time_14:00-15:00_others',
 'Reg_time_15:00-16:00',
 'Reg_time_15:00-16:00_total',
 'Reg_time_15:00-16:00_age18',
 'Reg_time_15:00-16:00_age45',
 'Reg_time_15:00-16:00_age60',
 'Reg_time_15:00-16:00_male',
 'Reg_time_15:00-16:00_female',
 'Reg_time_15:00-16:00_others',
 'Reg_time_16:00-17:00',
 'Reg_time_16:00-17:00_total',
 'Reg_time_16:00-17:00_age18',
 'Reg_time_16:00-17:00_age45',
 'Reg_time_16:00-17:00_age60',
 'Reg_time_16:00-17:00_male',
 'Reg_time_16:00-17:00_female',
 'Reg_time_16:00-17:00_others',
 'Reg_time_17:00-18:00',
 'Reg_time_17:00-18:00_total',
 'Reg_time_17:00-18:00_age18',
 'Reg_time_17:00-18:00_age45',
 'Reg_time_17:00-18:00_age60',
 'Reg_time_17:00-18:00_male',
 'Reg_time_17:00-18:00_female',
 'Reg_time_17:00-18:00_others',
 'Reg_time_18:00-19:00',
 'Reg_time_18:00-19:00_total',
 'Reg_time_18:00-19:00_age18',
 'Reg_time_18:00-19:00_age45',
 'Reg_time_18:00-19:00_age60',
 'Reg_time_18:00-19:00_male',
 'Reg_time_18:00-19:00_female',
 'Reg_time_18:00-19:00_others',
 'Reg_time_19:00-20:00',
 'Reg_time_19:00-20:00_total',
 'Reg_time_19:00-20:00_age18',
 'Reg_time_19:00-20:00_age45',
 'Reg_time_19:00-20:00_age60',
 'Reg_time_19:00-20:00_male',
 'Reg_time_19:00-20:00_female',
 'Reg_time_19:00-20:00_others',
 'Reg_time_20:00-21:00',
 'Reg_time_20:00-21:00_total',
 'Reg_time_20:00-21:00_age18',
 'Reg_time_20:00-21:00_age45',
 'Reg_time_20:00-21:00_age60',
 'Reg_time_20:00-21:00_male',
 'Reg_time_20:00-21:00_female',
 'Reg_time_20:00-21:00_others',
 'Reg_time_21:00-22:00',
 'Reg_time_21:00-22:00_total',
 'Reg_time_21:00-22:00_age18',
 'Reg_time_21:00-22:00_age45',
 'Reg_time_21:00-22:00_age60',
 'Reg_time_21:00-22:00_male',
 'Reg_time_21:00-22:00_female',
 'Reg_time_21:00-22:00_others',
 'Reg_time_22:00-23:00',
 'Reg_time_22:00-23:00_total',
 'Reg_time_22:00-23:00_age18',
 'Reg_time_22:00-23:00_age45',
 'Reg_time_22:00-23:00_age60',
 'Reg_time_22:00-23:00_male',
 'Reg_time_22:00-23:00_female',
 'Reg_time_22:00-23:00_others']

def addVaccinationTimeSlot(field, rowList, jsonData):
    label = ['07:00-08:00','08:00-09:00','09:00-10:00','10:00-11:00','11:00-12:00','12:00-13:00',
 '13:00-14:00','14:00-15:00','15:00-16:00','16:00-17:00','17:00-18:00','18:00-19:00','19:00-20:00',
 '20:00-21:00','21:00-22:00','22:00-23:00']
    tempList = []
    slotLabels = []
    for slot in jsonData[field]:
            slotLabels.append(slot['label'])
            tempList.append(slot['label'])
            tempList.append(slot['count'])
            tempList.append(slot['dose_one'])
            tempList.append(slot['dose_two'])

    for i in range(0,len(label)):
        if label[i] not in slotLabels:
            tempList[i:i] = [0,0,0,0]
    rowList.extend(tempList)

def addSecondLevelFields(firstLevelField, secondLevelField, rowList, jsonData):
    for key in jsonData[firstLevelField][secondLevelField]:
        rowList.append(jsonData[firstLevelField][secondLevelField][key])
        
def addVaccinationByAge(field, rowList, jsonData):
    for key in jsonData[field]:
        rowList.append(jsonData[field][key])
        
def addRegistrationTimeSlot(field, rowList, jsonData):
    label = ['00:00-01:00',
 '01:00-02:00',
 '02:00-03:00',
 '03:00-04:00',
 '04:00-05:00',
 '05:00-06:00',
 '06:00-07:00',
 '07:00-08:00',
 '08:00-09:00',
 '09:00-10:00',
 '10:00-11:00',
 '11:00-12:00',
 '12:00-13:00',
 '13:00-14:00',
 '14:00-15:00',
 '15:00-16:00',
 '16:00-17:00',
 '17:00-18:00',
 '18:00-19:00',
 '19:00-20:00',
 '20:00-21:00',
 '21:00-22:00',
 '22:00-23:00']
    slotLabels  = []
    tempList = []
    for slot in jsonData[field]:
        slotLabels.append(slot['label'])
        tempList.append(slot['label'])
        tempList.append(slot['total'])
        tempList.append(slot['age18'])
        tempList.append(slot['age45'])
         tempList.append(slot['age60'])
        tempList.append(slot['male'])
        tempList.append(slot['female'])
        tempList.append(slot['others'])
    for i in range(0,len(label)):
        if label[i] not in slotLabels:
            tempList[i:i] = [0,0,0,0,0,0,0,0]
    rowList.extend(tempList)

START_DATE = datetime.date(2021, 5, 4)
END_DATE  = datetime.date(2021, 5, 15)

dfVaccine = pd.DataFrame(columns=vaccineHeader)
dfRegis = pd.DataFrame(columns=regisHeader)
for day in pd.date_range(start=START_DATE.strftime('%Y-%m-%d'), end=END_DATE.strftime('%Y-%m-%d')):
    params = {'date': day.strftime(
            '%Y-%m-%d'), 'state_id': '', 'district_id': ''}
    response = requests.get(url=INDIA_URL, params=params)
    if(response.status_code == 200):
        vaccineList = []
        regisList = []
        vaccineList.append(day)
        regisList.append(day)
        print(day)
        jsonData = response.json()
        for key in jsonData.keys():
            if key == 'topBlock':
                addSecondLevelFields('topBlock', 'registration', regisList, jsonData)
                addSecondLevelFields('topBlock', 'vaccination', vaccineList, jsonData)
            elif key == 'vaccinationDoneByTime':
                addVaccinationTimeSlot(key,vaccineList, jsonData)
            elif key == 'aefiPercentage':
                vaccineList.append(jsonData[key])
            elif key == 'timeWiseTodayRegReport':
                addRegistrationTimeSlot(key, regisList, jsonData)
            elif key == 'vaccinationByAge':
                addVaccinationByAge(key, vaccineList, jsonData)
        dfVaccine.loc[len(dfVaccine)] = vaccineList   
        dfRegis.loc[len(dfRegis)] = regisList  

dfVaccine.to_csv('india_vaccine.csv')
dfRegis.to_csv('india_registration.csv')
